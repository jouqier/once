# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —à–∞—Ä–∏–Ω–≥–∞ —Å –ø—Ä–µ–≤—å—é (Inline Mode)

## –ß—Ç–æ —ç—Ç–æ?

–®–∞—Ä–∏–Ω–≥ —Å –ø—Ä–µ–≤—å—é –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∫—Ä–∞—Å–∏–≤—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —Å –ø–æ—Å—Ç–µ—Ä–æ–º —Ñ–∏–ª—å–º–∞, –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏ inline –∫–Ω–æ–ø–∫–æ–π –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è Mini App.

**–ü—Ä–∏–º–µ—Ä:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  [–ü–æ—Å—Ç–µ—Ä —Ñ–∏–ª—å–º–∞]            ‚îÇ
‚îÇ                             ‚îÇ
‚îÇ  Fight Club                 ‚îÇ
‚îÇ  ‚≠ê 8.4/10                  ‚îÇ
‚îÇ                             ‚îÇ
‚îÇ  An insomniac office...     ‚îÇ
‚îÇ                             ‚îÇ
‚îÇ  [‚ñ∂Ô∏è –û—Ç–∫—Ä—ã—Ç—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏]  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

–î–ª—è —Ä–∞–±–æ—Ç—ã —à–∞—Ä–∏–Ω–≥–∞ —Å –ø—Ä–µ–≤—å—é –Ω—É–∂–Ω–æ:

1. ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Web App (—É–∂–µ –µ—Å—Ç—å)
2. ‚úÖ –í–∫–ª—é—á–µ–Ω–Ω—ã–π Inline Mode –¥–ª—è –±–æ—Ç–∞
3. ‚úÖ –ö–æ–¥ –±–æ—Ç–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ inline –∑–∞–ø—Ä–æ—Å–æ–≤

## –®–∞–≥ 1: –í–∫–ª—é—á–∏—Ç–µ Inline Mode –≤ BotFather

1. –û—Ç–∫—Ä–æ–π—Ç–µ [@BotFather](https://t.me/BotFather)
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/mybots`
3. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ `@onceappbot`
4. –í—ã–±–µ—Ä–∏—Ç–µ "Bot Settings"
5. –í—ã–±–µ—Ä–∏—Ç–µ "Inline Mode"
6. –í—ã–±–µ—Ä–∏—Ç–µ "Turn on"
7. –û—Ç–ø—Ä–∞–≤—å—Ç–µ placeholder —Ç–µ–∫—Å—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä: "–ü–æ–∏—Å–∫ —Ñ–∏–ª—å–º–æ–≤...")

## –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–æ–¥ –±–æ—Ç–∞

–ë–æ—Ç –¥–æ–ª–∂–µ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å inline –∑–∞–ø—Ä–æ—Å—ã –∏ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏ —Å –ø—Ä–µ–≤—å—é.

### –ü—Ä–∏–º–µ—Ä –Ω–∞ Node.js (Telegraf)

```javascript
const { Telegraf, Markup } = require('telegraf');
const axios = require('axios');

const bot = new Telegraf(process.env.BOT_TOKEN);
const TMDB_API_KEY = process.env.TMDB_API_KEY;
const WEB_APP_URL = process.env.WEB_APP_URL;

// –û–±—Ä–∞–±–æ—Ç–∫–∞ inline –∑–∞–ø—Ä–æ—Å–æ–≤
bot.on('inline_query', async (ctx) => {
    const query = ctx.inlineQuery.query;
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–æ—Ä–º–∞—Ç: share_movie_550 –∏–ª–∏ share_tv_1396
    if (query.startsWith('share_')) {
        const parts = query.split('_');
        if (parts.length === 3) {
            const [, mediaType, mediaId] = parts;
            
            try {
                // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ —Ñ–∏–ª—å–º–µ/—Å–µ—Ä–∏–∞–ª–µ –∏–∑ TMDB
                const endpoint = mediaType === 'movie' ? 'movie' : 'tv';
                const response = await axios.get(
                    `https://api.themoviedb.org/3/${endpoint}/${mediaId}`,
                    {
                        params: {
                            api_key: TMDB_API_KEY,
                            language: 'ru-RU'
                        }
                    }
                );
                
                const data = response.data;
                const title = data.title || data.name;
                const overview = data.overview || '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç';
                const rating = data.vote_average ? `‚≠ê ${data.vote_average.toFixed(1)}/10` : '';
                const posterUrl = data.poster_path 
                    ? `https://image.tmdb.org/t/p/w500${data.poster_path}`
                    : '';
                
                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º Direct Link
                const directLink = `https://t.me/onceappbot/app?startapp=${mediaType}_${mediaId}`;
                
                // –§–æ—Ä–º–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                const result = {
                    type: 'article',
                    id: `${mediaType}_${mediaId}`,
                    title: title,
                    description: `${rating}\n${overview.substring(0, 100)}...`,
                    thumb_url: posterUrl,
                    input_message_content: {
                        message_text: `üé¨ ${title}\n${rating}\n\n${overview.substring(0, 200)}...`,
                        parse_mode: 'HTML'
                    },
                    reply_markup: {
                        inline_keyboard: [[
                            {
                                text: '‚ñ∂Ô∏è –û—Ç–∫—Ä—ã—Ç—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏',
                                url: directLink
                            }
                        ]]
                    }
                };
                
                await ctx.answerInlineQuery([result], {
                    cache_time: 300
                });
            } catch (error) {
                console.error('Error fetching movie data:', error);
                await ctx.answerInlineQuery([]);
            }
        }
    } else {
        // –ü—É—Å—Ç–æ–π –∑–∞–ø—Ä–æ—Å –∏–ª–∏ –æ–±—ã—á–Ω—ã–π –ø–æ–∏—Å–∫
        await ctx.answerInlineQuery([]);
    }
});

bot.launch();
```

### –ü—Ä–∏–º–µ—Ä –Ω–∞ Python (python-telegram-bot)

```python
from telegram import Update, InlineQueryResultArticle, InputTextMessageContent, InlineKeyboardButton, InlineKeyboardMarkup
from telegram.ext import Application, InlineQueryHandler, ContextTypes
import os
import requests

TMDB_API_KEY = os.getenv('TMDB_API_KEY')
WEB_APP_URL = os.getenv('WEB_APP_URL')
BOT_USERNAME = os.getenv('BOT_USERNAME')

async def inline_query(update: Update, context: ContextTypes.DEFAULT_TYPE):
    query = update.inline_query.query
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–æ—Ä–º–∞—Ç: share_movie_550 –∏–ª–∏ share_tv_1396
    if query.startswith('share_'):
        parts = query.split('_')
        if len(parts) == 3:
            _, media_type, media_id = parts
            
            try:
                # –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ TMDB
                endpoint = 'movie' if media_type == 'movie' else 'tv'
                response = requests.get(
                    f'https://api.themoviedb.org/3/{endpoint}/{media_id}',
                    params={
                        'api_key': TMDB_API_KEY,
                        'language': 'ru-RU'
                    }
                )
                data = response.json()
                
                title = data.get('title') or data.get('name')
                overview = data.get('overview', '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç')
                rating = f"‚≠ê {data['vote_average']:.1f}/10" if data.get('vote_average') else ''
                poster_url = f"https://image.tmdb.org/t/p/w500{data['poster_path']}" if data.get('poster_path') else ''
                
                # Direct Link
                direct_link = f"https://t.me/{BOT_USERNAME}/app?startapp={media_type}_{media_id}"
                
                # Inline –∫–Ω–æ–ø–∫–∞
                keyboard = InlineKeyboardMarkup([[
                    InlineKeyboardButton("‚ñ∂Ô∏è –û—Ç–∫—Ä—ã—Ç—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏", url=direct_link)
                ]])
                
                # –†–µ–∑—É–ª—å—Ç–∞—Ç
                result = InlineQueryResultArticle(
                    id=f"{media_type}_{media_id}",
                    title=title,
                    description=f"{rating}\n{overview[:100]}...",
                    thumb_url=poster_url,
                    input_message_content=InputTextMessageContent(
                        message_text=f"üé¨ {title}\n{rating}\n\n{overview[:200]}..."
                    ),
                    reply_markup=keyboard
                )
                
                await update.inline_query.answer([result], cache_time=300)
            except Exception as e:
                print(f"Error: {e}")
                await update.inline_query.answer([])
    else:
        await update.inline_query.answer([])

def main():
    application = Application.builder().token(os.getenv('BOT_TOKEN')).build()
    application.add_handler(InlineQueryHandler(inline_query))
    application.run_polling()

if __name__ == '__main__':
    main()
```

## –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É

1. –°–æ–±–µ—Ä–∏—Ç–µ –∏ —Ä–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –û—Ç–∫—Ä–æ–π—Ç–µ –ª—é–±–æ–π —Ñ–∏–ª—å–º –≤ Mini App
3. –ù–∞–∂–º–∏—Ç–µ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è"
4. –í—ã–±–µ—Ä–∏—Ç–µ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Å –ø—Ä–µ–≤—å—é"
5. Telegram –æ—Ç–∫—Ä–æ–µ—Ç –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ —á–∞—Ç–∞
6. –í—ã–±–µ—Ä–∏—Ç–µ —á–∞—Ç –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ
7. –í —á–∞—Ç–µ –ø–æ—è–≤–∏—Ç—Å—è –∫—Ä–∞—Å–∏–≤–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ —Å –ø–æ—Å—Ç–µ—Ä–æ–º –∏ –∫–Ω–æ–ø–∫–æ–π

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –ë–µ–∑ –∫–æ–¥–∞ –±–æ—Ç–∞

–ï—Å–ª–∏ –≤—ã –Ω–µ —Ö–æ—Ç–∏—Ç–µ –ø–∏—Å–∞—Ç—å –∫–æ–¥ –¥–ª—è –±–æ—Ç–∞, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π —à–∞—Ä–∏–Ω–≥:

1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–ø—Ü–∏—é "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –≤ Telegram" –≤–º–µ—Å—Ç–æ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Å –ø—Ä–µ–≤—å—é"
2. –≠—Ç–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç –ø—Ä–æ—Å—Ç—É—é —Ç–µ–∫—Å—Ç–æ–≤—É—é —Å—Å—ã–ª–∫—É –±–µ–∑ –ø—Ä–µ–≤—å—é
3. –ù–æ —Å—Å—ã–ª–∫–∞ –≤—Å—ë —Ä–∞–≤–Ω–æ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∏ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å Mini App

## Troubleshooting

### Inline Mode –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Å –ø—Ä–µ–≤—å—é" –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Inline Mode –≤–∫–ª—é—á–µ–Ω –≤ BotFather
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç inline –∑–∞–ø—Ä–æ—Å—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±–æ—Ç–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫

### –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–µ–≤—å—é

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–∞—Ä—Ç–æ—á–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è, –Ω–æ –±–µ–∑ –ø–æ—Å—Ç–µ—Ä–∞.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `thumb_url` —É–∫–∞–∑–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
2. URL –ø–æ—Å—Ç–µ—Ä–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ HTTPS
3. –†–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ –±–æ–ª–µ–µ 5MB

### –ö–Ω–æ–ø–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–Ω–æ–ø–∫–∞ "–û—Ç–∫—Ä—ã—Ç—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏" –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç Mini App.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç Direct Link –≤ –∫–æ–¥–µ –±–æ—Ç–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∫–æ—Ä–æ—Ç–∫–æ–µ –∏–º—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Web App –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ BotFather

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ü–µ–Ω–∏–ª —Ñ–∏–ª—å–º, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —ç—Ç–æ –≤ –∫–∞—Ä—Ç–æ—á–∫—É:

```javascript
const userRating = getUserRating(mediaId); // –í–∞—à–∞ —Ñ—É–Ω–∫—Ü–∏—è
const ratingText = userRating 
    ? `‚≠ê ${rating} | üë§ –ú–æ—è –æ—Ü–µ–Ω–∫–∞: ${userRating}/10`
    : `‚≠ê ${rating}`;
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∂–∞–Ω—Ä–æ–≤

```javascript
const genres = data.genres.map(g => g.name).join(', ');
const description = `${rating}\n${genres}\n\n${overview}`;
```

### –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏

```javascript
reply_markup: {
    inline_keyboard: [[
        { text: '‚ñ∂Ô∏è –°–º–æ—Ç—Ä–µ—Ç—å', url: directLink },
        { text: 'üìù –û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤', url: directLink }
    ]]
}
```

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –±–æ—Ç—É

–î–ª—è —Ä–∞–±–æ—Ç—ã inline mode –±–æ—Ç—É –Ω—É–∂–Ω—ã:

1. **TMDB API –∫–ª—é—á** - –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ —Ñ–∏–ª—å–º–∞—Ö
2. **–î–æ—Å—Ç—É–ø –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É** - –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ TMDB API
3. **–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞** - –±–æ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω 24/7

–ú–æ–∂–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –±–æ—Ç–∞ –Ω–∞:
- Heroku (–±–µ—Å–ø–ª–∞—Ç–Ω–æ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏)
- Railway
- Render
- VPS —Å–µ—Ä–≤–µ—Ä–µ
- Vercel (–¥–ª—è serverless —Ñ—É–Ω–∫—Ü–∏–π)
