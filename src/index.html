<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no, viewport-fit=cover">
    <meta name="format-detection" content="telephone=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="MobileOptimized" content="176">
    <meta name="HandheldFriendly" content="True">
    
    <title>Movie App</title>
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-RZRGXY0M6T"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        
        window.GA_MEASUREMENT_ID = 'G-RZRGXY0M6T';
        
        gtag('config', window.GA_MEASUREMENT_ID, {
            'send_page_view': false
        });
    </script>
    
    <script src="https://telegram.org/js/telegram-web-app.js" onerror="console.warn('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å Telegram WebApp SDK')"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function(){
            if (window.Telegram?.WebApp) {
                try {
                    Telegram.WebApp.disableVerticalSwipes();
                } catch (error) {
                    console.warn('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Telegram WebApp:', error);
                }
            }
        });
    </script>
    
    <!-- Telegram Mini Apps Analytics SDK -->
    <script 
        async 
        src="https://tganalytics.xyz/index.js" 
        type="text/javascript"
    ></script>
    <link rel="stylesheet" href="./theme.css">
    <link rel="stylesheet" href="./styles.css">
    
    <!-- –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <script>
        // –õ–æ–≥–∏—Ä—É–µ–º –Ω–∞—á–∞–ª–æ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        console.log('üìÑ HTML –∑–∞–≥—Ä—É–∂–µ–Ω');
        console.log('üåê User Agent:', navigator.userAgent);
        console.log('üîí –ü—Ä–æ—Ç–æ–∫–æ–ª:', window.location.protocol);
        console.log('üìç URL:', window.location.href);
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É –º–æ–¥—É–ª–µ–π
        const supportsModules = 'noModule' in HTMLScriptElement.prototype;
        console.log('üì¶ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ ES –º–æ–¥—É–ª–µ–π:', supportsModules);
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª–µ–π
        window.addEventListener('error', function(event) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', {
                filename: event.filename,
                message: event.message,
                lineno: event.lineno,
                colno: event.colno,
                error: event.error
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –µ—Å–ª–∏ –º–æ–¥—É–ª—å –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è
            if (event.filename && (event.filename.includes('main.js') || event.filename.includes('.js'))) {
                setTimeout(() => {
                    const container = document.querySelector('#movies-container');
                    if (container && (container.innerHTML.trim() === '' || container.innerHTML.includes('–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è'))) {
                        let errorMessage = '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –º–æ–¥—É–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è';
                        if (event.message.includes('Failed to fetch') || event.message.includes('network')) {
                            errorMessage = '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ HTTPS —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç';
                        } else if (event.message.includes('CORS')) {
                            errorMessage = '–û—à–∏–±–∫–∞ CORS. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞';
                        }
                        
                        container.innerHTML = `
                            <div style="padding: 20px; text-align: center; color: #fff;">
                                <h2>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</h2>
                                <p>${errorMessage}</p>
                                <p style="font-size: 12px; opacity: 0.7;">${event.message}</p>
                                <p style="font-size: 12px; opacity: 0.7;">–§–∞–π–ª: ${event.filename || '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</p>
                                <p style="font-size: 12px; opacity: 0.7;">–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –¥–ª—è –¥–µ—Ç–∞–ª–µ–π</p>
                            </div>
                        `;
                    }
                }, 2000);
            }
        }, true);
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –ø—Ä–æ–º–∏—Å–æ–≤
        window.addEventListener('unhandledrejection', function(event) {
            console.error('‚ùå –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–æ–º–∏—Å–∞:', event.reason);
        });
    </script>
    
    <script type="module" src="./main.js"></script>
    
    <!-- Fallback –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–æ–≤ –±–µ–∑ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –º–æ–¥—É–ª–µ–π -->
    <script nomodule>
        console.error('‚ùå –ë—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç ES –º–æ–¥—É–ª–∏');
        document.querySelector('#movies-container').innerHTML = `
            <div style="padding: 20px; text-align: center; color: #fff;">
                <h2>–ë—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è</h2>
                <p>–î–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π ES –º–æ–¥—É–ª–µ–π</p>
            </div>
        `;
    </script>
</head>
<body>
    <div id="app">
        <div class="corner-top"></div>
        <div class="corner-bottom"></div>
        <main>
            <div id="movies-container">
                <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
                <div style="padding: 20px; text-align: center; color: #fff;">
                    <p>–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...</p>
                </div>
            </div>
        </main>
        <tab-bar></tab-bar>
    </div>
    
    <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('‚úÖ DOM –∑–∞–≥—Ä—É–∂–µ–Ω');
            console.log('üì¶ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞–π–¥–µ–Ω:', !!document.querySelector('#movies-container'));
            console.log('üì¶ Tab bar –Ω–∞–π–¥–µ–Ω:', !!document.querySelector('tab-bar'));
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É —Å–∫—Ä–∏–ø—Ç–æ–≤
            setTimeout(() => {
                console.log('‚è±Ô∏è –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã –ø–æ—Å–ª–µ DOMContentLoaded:');
                console.log('  - Telegram SDK:', !!window.Telegram?.WebApp);
                console.log('  - Google Analytics:', !!window.gtag);
                console.log('  - Telegram Analytics:', !!window.telegramAnalytics);
                
                // –ï—Å–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤—Å–µ –µ—â–µ –ø—É—Å—Ç–æ–π –∏–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É, –∑–Ω–∞—á–∏—Ç main.js –Ω–µ –≤—ã–ø–æ–ª–Ω–∏–ª—Å—è
                const container = document.querySelector('#movies-container');
                if (container && container.innerHTML.includes('–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è')) {
                    console.error('‚ö†Ô∏è main.js –Ω–µ –≤—ã–ø–æ–ª–Ω–∏–ª—Å—è –∑–∞ 3 —Å–µ–∫—É–Ω–¥—ã');
                }
            }, 3000);
        });
    </script>
</body>
</html> 